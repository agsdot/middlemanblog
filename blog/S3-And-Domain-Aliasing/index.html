<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'>
    <meta content='Jonathan Lai' name='author'>
    <meta content="Jonathan Lai's personal portfolio and blog. Web developer, gadget geek, writer of code" name='description'>
    <meta content='Jonathan Lai, Web Development, Ruby, Ruby on Rails, CSS, JavaScript, Code' name='keywords'>
    <title>S3 and Domain Name Aliasing</title>
    <link href="../../stylesheets/site.css" media="screen" rel="stylesheet" type="text/css" />
    
  </head>
  <body class='blog blog_S3-And-Domain-Aliasing blog_S3-And-Domain-Aliasing_index'>
    <nav class='navbar navbar-inverse' role='navigation'>
      <div class='container'>
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class='navbar-header'>
          <button class='navbar-toggle' data-target='#bs-example-navbar-collapse-1' data-toggle='collapse' type='button'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
          <a class='navbar-brand' href='http://agsdot.github.io/thoughts/'>Jonathan Lai</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class='collapse navbar-collapse' id='bs-example-navbar-collapse-1'>
          <ul class='nav navbar-nav'>
            <li>
              <a href='http://twitter.com/jonlai' target='_blank'>Twitter</a>
            </li>
            <li>
              <a href='http://github.com/agsdot' target='_blank'>Github</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class='container' id='container'>
      <article>
        <h1>S3 and Domain Name Aliasing</h1>
        <p>I remember writing around Jan 28-29 about setting up a domain name with S3 and Route 53.  Honestly, with the past couple days doing things with nginx and EC2 and then later gitlab installations some of the S3 stuff is now a little fuzzy.</p>
        
        <p>But I&rsquo;m gonna do it. Fulfill that commitment to document &ldquo;it&rdquo; / what I did in a future post.  So here goes.</p>
        
        <p>First things first: follow pre-existing documentation.  I&rsquo;m not sure how the permalinks will change in the future for AWS, just do a google search for &ldquo;Setting Up a Static Website Using a Custom Domain&rdquo;.</p>
        
        <p>In the S3 section of the console, I created three buckets.</p>
        
        <ul>
        <li>domain.org</li>
        <li>logs.domain.org</li>
        <li>www.domain.org</li>
        </ul>
        
        <p>Let me go through each of them</p>
        
        <p>In domain.org, in &ldquo;Static Web Hosting&rdquo; I selected the radio button parameter for &ldquo;Enable website hosting&rdquo; and put the following in the fields for Index Document and Error document: index.html and error.html.  Logging was set to enabled and the target bucket was/is logs.domain.org . Target prefix set to root.</p>
        
        <p>In logs.domain.com , I forgot how this got there honestly, but there is a subfolder called root, which by now, mid/early feb has a bunch of logs inside.  Hum&hellip;google for that one once again.</p>
        
        <p>Anyhow to the aliasing part and that which I was frustrated with, and then it somehow set in, don&rsquo;t ask me how, maybe the whole dns servers updating on the internetz and all.  Ok www.domain.org how was this setup? In properties, in the category &ldquo;Static Website Hosting&rdquo; the radio button for &ldquo;Redirect all requests to another host name&rdquo; was selected, and in the text field for &ldquo;Redirect all requests to&rdquo; the following was typed in: domain.org</p>
        
        <p>That in and of itself allows one to have a domain.org.s3-website-us-west-2.amazonaws.com type of website.</p>
        
        <p>But one wants to get to the good stuff and have
        domain.org and www.domain.org goto the content of the website.</p>
        
        <p>Here&rsquo;s where its good to google the amazon documentation for &ldquo;Migrating an Existing Domain to Amazon Route 53&rdquo;</p>
        
        <p>In my 1and1 panel&ndash;I use both 1and1 and namecheap.  Been satisfied with them both.  Lifehacker though recommends for the value hunter to use namecheap.  Can&rsquo;t complain. Anyhow, in the 1and1 panel for DNS settings, I basically put the four aws route53 name servers there.  Thats it on the registrars end.</p>
        
        <p>Then in the AWS Route 53 console I do the following.</p>
        
        <p>Create an eltux.org Hosted zone.</p>
        
        <p>Then within that hosted zone, the following need to be configured:</p>
        
        <table><thead>
        <tr>
        <th align="left">Left align</th>
        <th align="left">Right align</th>
        <th align="left">Center align</th>
        </tr>
        </thead><tbody>
        <tr>
        <td align="left">domain.org</td>
        <td align="left">A</td>
        <td align="left">Alias s3-website-us-west-2.amazonaws.com.</td>
        </tr>
        <tr>
        <td align="left">domain.org</td>
        <td align="left">NS</td>
        <td align="left">4 name servers from Route 53, .org .co.uk .net and .com</td>
        </tr>
        <tr>
        <td align="left">domain.org</td>
        <td align="left">SOA</td>
        <td align="left">I think this already existed, (ns-1094.awsdns-08.org. awsdns-hostmaster.amazon.com.  5 number sets)</td>
        </tr>
        <tr>
        <td align="left">www.domain.org</td>
        <td align="left">CNAME</td>
        <td align="left">www.domain.org.s3-website-us-west-2.amazonaws.com</td>
        </tr>
        </tbody></table>
        
        <p>For the first one
        name is just domain.org
        Type is A IPv4 address
        Alias is YES
        Alias target is s3-website-us-west-2.amazonaws.com.</p>
        
        <p>For the second one
        Type is NS - nameserver
        Alias is NO
        Values are the 4 IP addresses from the Route53 nameservers
        Routing policy is simple</p>
        
        <p>For the third one,
        I honestly don&rsquo;t recall touching this one, but this is documentation for posterity&rsquo;s sake and also if I need to repeat the procedure:
        Type: SOA Start of Authority
        Alias NO
        Values Those values listed above in the table
        Routing policy simple</p>
        
        <p>For the fourth one
        Type: CNAME
        Values: www.domain.org.s3-website-us-west-2.amazonaws.com
        Routing Policy: Simple</p>
        
        <p>Let time pass and the settings kick in on the global dns servers.  And then tada it worked.</p>
        
        <p>Wow&hellip;that was a bucketful. Pun intended, hahaha.</p>
        
        <p>Hum&hellip;things I forgot</p>
        
        <ul>
        <li>How did I get those four nameserver addresses from Route 53?  Hum&hellip;I&rsquo;ll have to go into the Amazon docs again for that, and google those two documents.</li>
        <li>Did I really need to use Route53 for setting up the domain names for S3?  It costs 50 cents a month.  Not terribly expensive, but if I already pay for a domain per year with namecheap and 1and1, and I don&rsquo;t get a terrible amount of traffic, why fork over 50 cents a month to AMZN.</li>
        </ul>
        
        <p>Anyhow, just ponderings, and thoughts after typing up a very long post documenting my AMZN S3 experimentations.</p>
        
        <p>Enjoy folks,</p>
        
        <p>JL</p>
        <div class='meta'>
          <div class='post-date'>
            <h5>
              Posted On:
            </h5>
            <time datetime='2014-02-d'>February 10, 2014</time>
          </div>
          <div class='tags'>
            <h5>Tagged:</h5>
            <ul>
              <!-- = current_page.tags.map { |tag| link_to tag, tag_path(tag) }.join(', ') -->
              <!-- %p -->
              <a href="http://agsdot.github.io/thoughts/blog/tags/s3">S3</a>, <a href="http://agsdot.github.io/thoughts/blog/tags/aws">AWS</a>, <a href="http://agsdot.github.io/thoughts/blog/tags/domains">domains</a>, <a href="http://agsdot.github.io/thoughts/blog/tags/nameservers">nameservers</a>
            </ul>
          </div>
        </div>
        <div class='other'></div>
        <p>&#32;</p>
        <div id='disqus_thread'></div>
        <script>
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'agsdotgithubthoughts'; // required: replace example with your forum shortname
          
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>
          Please enable JavaScript to view the
          <a href='http://disqus.com/?ref_noscript'>comments powered by Disqus.</a>
        </noscript>
        <a class='dsq-brlink' href='http://disqus.com'>
          comments powered by
          <span class='logo-disqus'>Disqus</span>
        </a>
      </article>
    </div>
    <footer>
      <p>&copy; Jonathan Lai 2013</p>
    </footer>
    <!-- %script{ :src => '//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js' } -->
    <!-- %script -->
    <!-- window.jQuery || document.write("<script src='js/libs/jquery-1.7.2.min.js'>\x3C/script>") -->
    <!--[if lt IE 7]>
      <script src="../../javascripts/libs/DD_belatedPNG_0.0.8a-min.js" type="text/javascript"></script>
      <script>
        DD_belatedPNG.fix("img, .png_bg");
      </script>
    <![endif]-->
    <!-- = javascript_include_tag "libs/jquery-1.10.2.min.js" -->
    <!-- = javascript_include_tag "all" -->
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
    <script src='http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js'></script>
    <!-- = disqus -->
  </body>
</html>

